 // Project data for modals
        const projectsData = {
            1: {
                title: "Design and Validation of a Thermal Engine",
                image: [
                    "https://images.unsplash.com/photo-1551650975-87deedd944c3?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1074&q=80",
                    "https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=1074&q=80",
                    "https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=1074&q=80"
                ],
                description: "Thermo-mechanical analysis and energy optimization – ANSYS, CATIA, SOLIDWORKS",
                fullDescription: "This project involved the comprehensive design and validation of a thermal engine with a focus on performance optimization, energy efficiency, and emission reduction. The design process incorporated advanced thermo-mechanical modeling techniques and careful material selection to enhance both durability and operational efficiency.",
                features: [
                    "Optimized thermal engine design for performance and efficiency",
                    "Advanced thermo-mechanical modeling and simulation",
                    "Material selection for enhanced durability",
                    "Innovative combustion and heat transfer technologies",
                    "Comprehensive simulation and validation processes",
                    "Compliance with industrial and environmental standards"
                ],
                technologies: ["CATIA", "SolidWorks", "Abaqus", "ANSYS", "Thermal Analysis", "Material Science"],
                liveDemo: "#",
                github: "#"
            },
            2: {
                title: "Design of a Pressure Control System in a Hydraulic Circuit",
                image: [
                    "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1115&q=80",
                    "https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=1074&q=80"
                ],
                description: "This project aims to design and simulate a hydraulic pressure control system using MATLAB/Simulink.",
                fullDescription: "This project focused on the design and simulation of a sophisticated hydraulic pressure control system. Using MATLAB/Simulink, we modeled the system dynamics and implemented a PID controller to ensure stable and precise pressure regulation under various operating conditions. The system demonstrates excellent performance in maintaining desired pressure levels despite external disturbances.",
                features: [
                    "Dynamic modeling of hydraulic systems",
                    "PID controller implementation for pressure regulation",
                    "Stability analysis under varying conditions",
                    "Real-time pressure monitoring and control",
                    "System performance optimization",
                    "Simulation validation with real-world parameters"
                ],
                technologies: ["MATLAB", "Simulink", "PID Control", "Hydraulic Systems", "System Dynamics", "Control Theory"],
                liveDemo: "#",
                github: "#"
            },
            3: {
                title: "Automotive Diagnostics System",
                image: [
                    "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1115&q=80",
                    "https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=1074&q=80"
                ],
                 description: "Microcontroller-Based Automotive Monitoring Project",
                fullDescription: "This project developed a comprehensive automotive diagnostics system using microcontroller technology. The system monitors various vehicle parameters in real-time, providing valuable insights into vehicle health and performance. It includes features for fault detection, performance analysis, and predictive maintenance alerts.",
                features: [
                    "Real-time monitoring of vehicle parameters",
                    "Fault detection and diagnostic capabilities",
                    "Performance analysis and reporting",
                    "Predictive maintenance alerts",
                    "User-friendly interface for data visualization",
                    "Compatible with various vehicle systems"
                ],
                technologies: ["C/C++", "Assembly", "MPLAB X IDE", "PROTEUS", "PIC Microcontrollers", "Embedded Systems"],
                liveDemo: "#",
                github: "https://github.com/MOHAMEDDAGMOUMI97/Automotive_Diagnostic_System/tree/main"
            },
            4: {
                title: "Design and Optimization of an ABS System (Anti-Lock Braking System)",
                image: [
                    "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1115&q=80",
                    "https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=1074&q=80"
                ],
                description: "Mechanical design and structural analysis of an Anti-Lock Braking System",
                fullDescription: "This project involved the comprehensive design and optimization of an Anti-Lock Braking System (ABS) to enhance vehicle safety and braking efficiency. Using CATIA and SolidWorks for 3D modeling, and Abaqus for finite element analysis, the system was meticulously designed and optimized to deliver superior performance and reliability under real-world driving conditions.",
                features: [
                    "3D modeling of ABS components using CATIA and SolidWorks",
                    "Finite element analysis for structural integrity",
                    "Optimization for enhanced braking performance",
                    "Safety and reliability validation",
                    "Compatibility with various vehicle types",
                    "Performance testing under different conditions"
                ],
                technologies: ["CATIA", "SolidWorks", "Abaqus", "Mechanical Design", "Finite Element Analysis", "Validation"],
                liveDemo: "#",
                github: "#"
            },
            5: {
                title: "Amplitude Modulation",
                image: [
                    "https://images.unsplash.com/photo-1460925895917-afdab827c52f?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1115&q=80",
                    "https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=1074&q=80"
                ],
                description: "Fundamental communication technique for transmitting information via radio waves",
                fullDescription: "This project explores Amplitude Modulation (AM), a fundamental technique in communication systems where the amplitude of a carrier signal is varied in accordance with the information signal. The project demonstrates how audio or data can be efficiently transmitted over long distances using radio waves, providing practical insights into signal processing and the foundational principles of modern communication systems.",
                features: [
                    "Implementation of amplitude modulation technique",
                    "Carrier signal generation and modulation",
                    "Demodulation for signal recovery",
                    "Analysis of signal quality and integrity",
                    "Practical applications in communication systems",
                    "Understanding of radio wave transmission"
                ],
                technologies: ["PROTEUS", "Signal Processing", "Communication Systems", "Circuit Design", "Modulation Theory"],
                liveDemo: "#",
                github: "#"
            }
        };

        // Mobile Menu Toggle
        const menuToggle = document.getElementById('menuToggle');
        const navLinks = document.getElementById('navLinks');
        
        menuToggle.addEventListener('click', () => {
            navLinks.classList.toggle('active');
            const isExpanded = navLinks.classList.contains('active');
            menuToggle.setAttribute('aria-expanded', isExpanded);
        });
        
        // Close menu when clicking on a link
        document.querySelectorAll('.nav-links a').forEach(link => {
            link.addEventListener('click', () => {
                navLinks.classList.remove('active');
                menuToggle.setAttribute('aria-expanded', 'false');
            });
        });
        
        // Close menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!navLinks.contains(e.target) && !menuToggle.contains(e.target)) {
                navLinks.classList.remove('active');
                menuToggle.setAttribute('aria-expanded', 'false');
            }
        });
        
        // Modal functionality
        const modal = document.getElementById('projectModal');
        const closeModal = document.querySelector('.close-modal');
        const modalBody = document.querySelector('.modal-body');

        // Open modal when clicking "View Details" or project card
        document.querySelectorAll('.project-card, .view-details').forEach(element => {
            element.addEventListener('click', (e) => {
                // Don't open modal if clicking on links
                if (e.target.tagName === 'A' || e.target.closest('a')) {
                    return;
                }
                
                const projectId = element.getAttribute('data-project');
                openModal(projectId);
            });
        });

        // Close modal functions
        closeModal.addEventListener('click', closeModalFunc);

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                closeModalFunc();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modal.style.display === 'block') {
                closeModalFunc();
            }
        });
        //



        function openModal(projectId) {
            const project = projectsData[projectId];
            if (!project) return;

            // Generate carousel HTML
            const carouselHTML = `
                <div class="modal-carousel" data-modal-carousel="${projectId}">
                    ${project.image.map((img, index) => `
                        <div class="modal-carousel-slide ${index === 0 ? 'active' : ''}">
                            <img src="${img}" alt="${project.title} - Image ${index + 1}" loading="lazy">
                        </div>
                    `).join('')}
            
                    <button class="modal-carousel-nav modal-carousel-prev">‹</button>
                    <button class="modal-carousel-nav modal-carousel-next">›</button>
                    
                    <div class="modal-carousel-counter">
                        <span class="modal-current-slide">1</span>/<span class="modal-total-slides">${project.image.length}</span>
                    </div>
                    
                    <div class="modal-carousel-controls">
                        ${project.image.map((_, index) => `
                            <button class="modal-carousel-dot ${index === 0 ? 'active' : ''}" data-modal-slide="${index}"></button>
                        `).join('')}
                    </div>
                </div>
            `;

            modalBody.innerHTML = `
                ${carouselHTML}
                <h2 class="modal-title">${project.title}</h2>
                <p class="modal-description">${project.fullDescription}</p>
                
                <div class="modal-features">
                    <h4>Key Features</h4>
                    <ul>
                        ${project.features.map(feature => `<li>${feature}</li>`).join('')}
                    </ul>
                </div>
        
                <div class="modal-tech">
                    ${project.technologies.map(tech => `<span class="tech-tag">${tech}</span>`).join('')}
                </div>
                
                <div class="modal-links">
                    ${project.liveDemo !== '#' ? `<a href="${project.liveDemo}" class="modal-link" target="_blank"><i class="fas fa-external-link-alt"></i> Live Demo</a>` : ''}
                    ${project.github !== '#' ? `<a href="${project.github}" class="modal-link outline" target="_blank"><i class="fab fa-github"></i> Source Code</a>` : ''}
                </div>
            `;

            modal.style.display = 'block';
            document.body.style.overflow = 'hidden';
            
            // Initialize modal carousel
            initializeModalCarousel(projectId);
        }

        function closeModalFunc() {
            modal.style.display = 'none';
            document.body.style.overflow = 'auto'; // Re-enable scrolling
        }
        
        // Simple form submission handler
        document.getElementById('contactForm').addEventListener('submit', function(e) {
            e.preventDefault();
			const form = this;
             const submitBtn = form.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
           
            // Show loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Sending...';
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;

		// Formspree endpoint
		    const url = form.getAttribute('action'); // You can keep the action in the form HTML

			
		 // Alternatively, you can set the url directly: const url = 'https://formspree.io/f/mnngyego';
			fetch(url, {
				method: 'POST',
				body: new FormData(form),
				headers: {
					'Accept': 'application/json'
				}
			})

			.then(response => {
		        if (response.ok) {
		            alert('Thank you for your message! I will get back to you soon.');
		            form.reset();
		        } else {
		            return response.json().then(err => {
		                throw new Error(err.error || 'Form submission failed');
		            });
		        }
    		})

			 .catch(error => {
		        alert('There was an error sending your message. Please try again. Error: ' + error.message);
			    })
			.finally(() => {
				submitBtn.innerHTML = originalText;
				submitBtn.classList.remove('loading');
				submitBtn.disabled = false;
				});
			});
            // Simulate form submission
         /*   setTimeout(() => {
                alert('Thank you for your message! I will get back to you soon.');
                this.reset();
                submitBtn.innerHTML = originalText;
                submitBtn.classList.remove('loading');
            }, 1500);
        });
        */
        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
        
        // Add active class to navigation links based on scroll position
        window.addEventListener('scroll', () => {
            let current = '';
            const sections = document.querySelectorAll('section');
            const scrollPosition = window.scrollY + 100;
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (scrollPosition >= sectionTop && scrollPosition < sectionTop + sectionHeight) {
                    current = section.getAttribute('id');
                }
            });

            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });
        
        // Lazy loading for images
        if ('IntersectionObserver' in window) {
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove('lazy');
                        imageObserver.unobserve(img);
                    }
                });
            });

            document.querySelectorAll('img[data-src]').forEach(img => {
                imageObserver.observe(img);
            });
        }
        
        // Add loading state for external links
        document.querySelectorAll('a[href^="http"]').forEach(link => {
            link.setAttribute('target', '_blank');
            link.setAttribute('rel', 'noopener noreferrer');
        });


        // Image Carousel Functionality
        function initializeCarousels() {
            const carousels = document.querySelectorAll('.carousel-container');
            
            carousels.forEach(carousel => {
                const slides = carousel.querySelectorAll('.carousel-slide');
                const dots = carousel.querySelectorAll('.carousel-dot');
                const prevBtn = carousel.querySelector('.carousel-prev');
                const nextBtn = carousel.querySelector('.carousel-next');
                const currentSlide = carousel.querySelector('.current-slide');
                const totalSlides = carousel.querySelector('.total-slides');
                
                let currentIndex = 0;
                totalSlides.textContent = slides.length;
                
                function showSlide(index) {
                    // Remove active class from all slides and dots
                    slides.forEach(slide => slide.classList.remove('active'));
                    dots.forEach(dot => dot.classList.remove('active'));
                    
                    // Add active class to current slide and dot
                    slides[index].classList.add('active');
                    dots[index].classList.add('active');
                    
                    // Update counter
                    currentSlide.textContent = index + 1;
                    currentIndex = index;
                }
                
                // Next slide
                function nextSlide() {
                    let newIndex = currentIndex + 1;
                    if (newIndex >= slides.length) {
                        newIndex = 0;
                    }
                    showSlide(newIndex);
                }
                
                // Previous slide
                function prevSlide() {
                    let newIndex = currentIndex - 1;
                    if (newIndex < 0) {
                        newIndex = slides.length - 1;
                    }
                    showSlide(newIndex);
                }
                
                // Event listeners
                nextBtn.addEventListener('click', nextSlide);
                prevBtn.addEventListener('click', prevSlide);
                
                // Dot navigation
                dots.forEach((dot, index) => {
                    dot.addEventListener('click', () => {
                        showSlide(index);
                    });
                });
                
                // Auto-advance (optional)
                let autoAdvance = setInterval(nextSlide, 5000);
                
                // Pause auto-advance on hover
                carousel.addEventListener('mouseenter', () => {
                    clearInterval(autoAdvance);
                });
                
                carousel.addEventListener('mouseleave', () => {
                    autoAdvance = setInterval(nextSlide, 5000);
                });
                
                // Touch swipe support for mobile
                let startX = 0;
                let endX = 0;
                
                carousel.addEventListener('touchstart', (e) => {
                    startX = e.touches[0].clientX;
                });
                
                carousel.addEventListener('touchend', (e) => {
                    endX = e.changedTouches[0].clientX;
                    handleSwipe();
                });
                
                function handleSwipe() {
                    const swipeThreshold = 50;
                    const diff = startX - endX;
                    
                    if (Math.abs(diff) > swipeThreshold) {
                        if (diff > 0) {
                            nextSlide(); // Swipe left
                        } else {
                            prevSlide(); // Swipe right
                        }
                    }
                }

                
            });
        }

        // Modal Carousel Functionality
        function initializeModalCarousel(projectId) {
            const carousel = document.querySelector(`[data-modal-carousel="${projectId}"]`);
            if (!carousel) return;
            
            const slides = carousel.querySelectorAll('.modal-carousel-slide');
            const dots = carousel.querySelectorAll('.modal-carousel-dot');
            const prevBtn = carousel.querySelector('.modal-carousel-prev');
            const nextBtn = carousel.querySelector('.modal-carousel-next');
            const currentSlide = carousel.querySelector('.modal-current-slide');
            const totalSlides = carousel.querySelector('.modal-total-slides');
            
            let currentIndex = 0;
            totalSlides.textContent = slides.length;
            
            function showSlide(index) {
                // Remove active class from all slides and dots
                slides.forEach(slide => slide.classList.remove('active'));
                dots.forEach(dot => dot.classList.remove('active'));
                
                // Add active class to current slide and dot
                slides[index].classList.add('active');
                dots[index].classList.add('active');
                
                // Update counter
                currentSlide.textContent = index + 1;
                currentIndex = index;
            }
            
            // Next slide
            function nextSlide() {
                let newIndex = currentIndex + 1;
                if (newIndex >= slides.length) {
                    newIndex = 0;
                }
                showSlide(newIndex);
            }
            
            // Previous slide
            function prevSlide() {
                let newIndex = currentIndex - 1;
                if (newIndex < 0) {
                    newIndex = slides.length - 1;
                }
                showSlide(newIndex);
            }
            
            // Event listeners
            nextBtn.addEventListener('click', nextSlide);
            prevBtn.addEventListener('click', prevSlide);
            
            // Dot navigation
            dots.forEach((dot, index) => {
                dot.addEventListener('click', () => {
                    showSlide(index);
                });
            });
            
            // Keyboard navigation
            function handleKeydown(e) {
                if (modal.style.display === 'block') {
                    if (e.key === 'ArrowLeft') {
                        prevSlide();
                    } else if (e.key === 'ArrowRight') {
                        nextSlide();
                    }
                }
            }
            
            document.addEventListener('keydown', handleKeydown);
            
            // Clean up event listener when modal closes
            const originalCloseModalFunc = closeModalFunc;
            window.closeModalFunc = function() {
                document.removeEventListener('keydown', handleKeydown);
                originalCloseModalFunc();
            };
            
            // Auto-advance (optional)
            let autoAdvance = setInterval(nextSlide, 4000);
            
            // Pause auto-advance on hover
            carousel.addEventListener('mouseenter', () => {
                clearInterval(autoAdvance);
            });
            
            carousel.addEventListener('mouseleave', () => {
                autoAdvance = setInterval(nextSlide, 4000);
            });
            
            // Touch swipe support for mobile
            let startX = 0;
            let endX = 0;
            
            carousel.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
            });
            
            carousel.addEventListener('touchend', (e) => {
                endX = e.changedTouches[0].clientX;
                handleSwipe();
            });
            
            function handleSwipe() {
                const swipeThreshold = 50;
                const diff = startX - endX;
                
                if (Math.abs(diff) > swipeThreshold) {
                    if (diff > 0) {
                        nextSlide(); // Swipe left
                    } else {
                        prevSlide(); // Swipe right
                    }
                }
            }
        }



        // Initialize carousels when page loads
        document.addEventListener('DOMContentLoaded', initializeCarousels);
